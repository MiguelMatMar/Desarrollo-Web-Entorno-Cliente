<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: script.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: script.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Añadir el input file al cargar el DOM
 */
document.addEventListener('DOMContentLoaded',() => {
    // Creamos el file para seleccionar documentos
    let fileSeleccionDocumentos = document.createElement('input');
    fileSeleccionDocumentos.type = 'file';
    fileSeleccionDocumentos.id = 'fileSeleccionDocumentos';
    fileSeleccionDocumentos.multiple = true;
    document.body.appendChild(fileSeleccionDocumentos);

    // Añadimos el evento para cuando se vaya a cargar el archivo
    document.getElementById('fileSeleccionDocumentos').addEventListener('change', leerArchivo);
});

/**
 * Comprobar los archivos seleccionados y leemos su contenido
 * @param {Event} evento - El evento de cambio del input
 */
function leerArchivo(evento){

    let archivos = evento.target.files;
    let permitidos = ['.txt','.lst','.csv'];

    archivos = Array.from(archivos); // Convertimos a array para poder usar forEach
    archivos.forEach(archivo => { // Analizamos la extension de cada archivo, por si no esta permitido
        let extension = archivo.name.split('.').pop();
        if(!permitidos.includes('.' + extension)){
            return; // Si no esta permitido, salimos
        }

        // Leemos el contenido de los archivos permitidos
        let lector = new FileReader();
        lector.onload = (eventoCarga) => {
            let saltoFila = document.createElement('br');
            document.body.appendChild(saltoFila);
            // Guardamos todo el contenido en un array separado por ,
            let contenido = eventoCarga.target.result.split(','); 

            // Creamos el input de las letras por palabra y lo cargamos al dom
            let textoLetras = document.createElement('p');
            textoLetras.innerText = "¿Letras por palabra?:";
            document.body.appendChild(textoLetras);
            let formularioLetrasPalabra = document.createElement('input');
            formularioLetrasPalabra.type = 'number';
            formularioLetrasPalabra.id = 'formularioLetrasPalabra' + archivo.name; // Creamos el id unico para cada archivo
            document.body.appendChild(formularioLetrasPalabra);

            // Creamos el input de las columnas por fila y lo cargamos al dom
            let textoFilas = document.createElement('p');
            textoFilas.innerText = "¿Columnas por fila?:";
            document.body.appendChild(textoFilas);
            let letrasPorFila = document.createElement('input');
            letrasPorFila.type = 'number';
            letrasPorFila.id = 'letrasPorFila' + archivo.name;
            document.body.appendChild(letrasPorFila);

            // Creamos el boton para crear la tabla para generar las palabras
            let botonGenerarTabla = document.createElement('button');
            botonGenerarTabla.textContent = 'Genera palabras';
            botonGenerarTabla.id = 'botonGenerarTabla' + archivo.name;
            document.body.appendChild(botonGenerarTabla);

            // Obtenemos los 2 inputs generados anteriormente para añadirle el evento al boton
            botonGenerarTabla.addEventListener('click', () => {
                // Validación de números positivos y no vacíos
                let valLetras = parseInt(formularioLetrasPalabra.value);
                let valColumnas = parseInt(letrasPorFila.value);

                if (isNaN(valLetras) || valLetras &lt;= 0 || isNaN(valColumnas) || valColumnas &lt;= 0) {
                    alert("Por favor, introduce números válidos y mayores a 0");
                    return;
                }

                cargarDocumentoDOM(contenido, valColumnas, valLetras);
                botonGenerarTabla.disabled = true;
            });

            // Hacemos lo mismo con el otro boton
            let bottonGenerarCSV = document.createElement('button');
            bottonGenerarCSV.textContent = 'Generar CSV';
            bottonGenerarCSV.id = 'bottonGenerarCSV' + archivo.name;
            document.body.appendChild(bottonGenerarCSV);
            bottonGenerarCSV.addEventListener('click', () => {
                generarCsv(archivo.name, [contenido]);
                console.log(archivo.name);
                bottonGenerarCSV.disabled = true;
            });
            document.body.appendChild(saltoFila);
        };
        lector.readAsText(archivo);
    });
};

/**
 * Simplemente creamos la tabla
 * @param {Array} array - Contenido a procesar
 * @param {number} columnasPorFila - Columnas deseadas
 * @param {number} letraPorPalabra - Longitud de las palabras
 */
function cargarDocumentoDOM(array, columnasPorFila, letraPorPalabra) {
    let nodoTabla = document.createElement('table');
    let contenidoTabla = "&lt;tr>";
    let contadorFilas = 0;
    let cantidadFilas = parseInt(columnasPorFila);

    // Filtramos el array para que solo contenga palabras con la longitud del usuario
    let palabrasFiltradas = array.filter(palabra => palabra.trim().length === parseInt(letraPorPalabra));
    
    palabrasFiltradas.forEach(palabra => {
        contadorFilas++;
        if(contadorFilas === cantidadFilas){
            contenidoTabla += `&lt;td>${palabra}&lt;/td>&lt;/tr>&lt;tr>`;
            contadorFilas = 0;
        }else{
            contenidoTabla += `&lt;td>${palabra}&lt;/td>`;
        }
    })
    
    contenidoTabla += "&lt;/tr>";
    nodoTabla.innerHTML = contenidoTabla;
    document.body.appendChild(nodoTabla);
}

/**
 * Generar el archivo CSV
 * @param {string} nombreArchivo - Nombre del archivo original
 * @param {Array} arrayContenido - Datos para el CSV
 */
function generarCsv(nombreArchivo,arrayContenido){
    // Cambiamos las , por enters
    let contenidoCsv = arrayContenido.map(fila => fila.join(",")).join("\n");
    // Creamos el archivo con el contenido previo
    let blob = new Blob([contenidoCsv], { type: 'text/csv;charset=utf-8;' });

    let nombreArchivoSinExtension = nombreArchivo.replace(/\.[^/.]+$/, ""); // Remplazamos todo lo que vaya despues del punto por nada, asi le quitamos la extension

    // Creamos el link para descargar de forma automatica el documento
    let link = document.createElement("a");
    let url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", nombreArchivoSinExtension.endsWith(".csv") ? nombreArchivoSinExtension : nombreArchivoSinExtension + ".csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#cargarDocumentoDOM">cargarDocumentoDOM</a></li><li><a href="global.html#generarCsv">generarCsv</a></li><li><a href="global.html#leerArchivo">leerArchivo</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sun Feb 01 2026 22:06:39 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
